<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>XTL: Parsing.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_tiny.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XTL
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">eXtended Template Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_parsing_8md.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Parsing.md</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Parsing</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;=======</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Parsing is an extensive subject and a frequent stumbling block of even experienced engineers.  Due to the repetitive nature of parsing code, the volume of the points of failure and the frequently changing format of inputs, parsing code is often a significant resource sink <span class="keywordflow">for</span> many software projects.</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Parsing is frequently outlined with a grammar specification in [Backus-Naur Form (BNF)](https:<span class="comment">//en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form) which defines the terminals and non-terminals that must be tagged in the input stream. Some tools accept the BNF grammar directly as input and generate all the parsing code as output. These tools are called parser-generators and they can save a lot of pain and time. Though not limited to accepting BNF exclusively as inputs, some parser-generates have custom language specifications or decorate BNF with various text handling code, the basic product is normally the same: some language specification is taken as input and all the boiler plate parsing code is generated as output. In most cases the resulting generated parser includes some interfaces for the library consumer to interrogate the parsed sources. Frequently, the parsed inputs are then feed as inputs to another stage which produces an [Abstract Syntax Tree (AST)](https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form). The AST is most often the primary model that applications use to work with the inputs.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Some applications <span class="keywordflow">do</span> not use generated parsers nor an AST. Some apps <span class="keywordflow">do</span> not even <span class="keyword">abstract</span> the parsing code from the processing code and will instead parse the inputs directly in-line with application logic. For all except the most trivial applications <span class="keyword">this</span> is a recipe <span class="keywordflow">for</span> disaster. Abstracting the two tasks is almost always the preferred method. However, doing things <span class="stringliteral">&#39;right&#39;</span> and adhering to best practice is also time consuming. For example, <span class="keyword">using</span> the traditional GNU tools to handle parsing is an entire discipline of it<span class="stringliteral">&#39;s own that complicates the build process and requires a modicum of domain expertise before any application logic is ever addressed. Modern tools such as Boost::Spirit and Antlr suffer from the same problem of requiring a detailed study of the library to get a simple parse task accomplished.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="stringliteral">When the introduction of a tool that is intended to simplify a problem makes the problem more complicated the tool looses it&#39;</span>s utility and usefullness. Since <span class="keyword">using</span> these tools require a significant investiment to learn and use properly it<span class="stringliteral">&#39;s no surprise that so many developers just opt to hand-roll a parser rather than learn yet another library. With all that said I introduce yet another library.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="stringliteral">Introduction</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="stringliteral">------------</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="stringliteral">XTL::parse uses template meta-programming techniques to generate parse trees from a grammar specification.  The grammar specification is written in C++ templates. The library is header-only and the parse trees are generated at compile time so there&#39;</span>s no libraries to link to and no external tools to run as part of the build process. A unique feature of XTL::parse is that the grammar specification gets instantiated as the [AST] when the parse is successful which eleminates the need <span class="keywordflow">for</span> an additional <span class="keyword">import</span> step which is frequent of other similar tools. XTL::parse is a simple LL(k) parser that encourages embedding the grammar specification in the AST for simplicity and clarity.</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;To illustrate the entire process, here&#39;s a simple BNF grammar describing the command line syntax of example_parse1.cpp:</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;~~~{.cpp}</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//terminals</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;&lt;red&gt;           := <span class="stringliteral">&#39;red&#39;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;&lt;green&gt;         := <span class="stringliteral">&#39;green&#39;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;&lt;blue&gt;          := <span class="stringliteral">&#39;blue&#39;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;&lt;one&gt;           := <span class="charliteral">&#39;1&#39;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;&lt;three&gt;         := <span class="charliteral">&#39;3&#39;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;&lt;five&gt;          := <span class="charliteral">&#39;5&#39;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;&lt;dash_color&gt;    := <span class="stringliteral">&#39;--color=&#39;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;&lt;dash_prime&gt;    := <span class="stringliteral">&#39;--prime=&#39;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//rules</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;&lt;rgb&gt;           := &lt;red&gt; | &lt;green&gt; | &lt;blue&gt;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;&lt;prime_num&gt;     := &lt;one&gt; | &lt;three&gt; | &lt;five&gt;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;&lt;color_param&gt;   := &lt;dash_color&gt; &lt;rgb&gt;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;&lt;prime_param&gt;   := &lt;dash_prime&gt; &lt;prime_num&gt;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;&lt;parameter&gt;     := &lt;color_param&gt; | &lt;prime_param&gt;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;~~~</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;&gt; If the intention of <span class="keyword">this</span> BNF syntax is unclear there are plenty of tutorials on the web.</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;This is the sort of BNF that is frequently encountered in RFCs, white papers, programming language and protocol specifications. It maps into a XTL::parse grammar specification as:</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;~~~{.cpp}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//termnals</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<a class="code" href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a>(red, <span class="stringliteral">&quot;red&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a>(green, <span class="stringliteral">&quot;green&quot;</span>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a>(blue, <span class="stringliteral">&quot;blue&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<a class="code" href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a>(one, <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<a class="code" href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a>(three, <span class="stringliteral">&quot;3&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<a class="code" href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a>(five, <span class="stringliteral">&quot;5&quot;</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<a class="code" href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a>(dash_color, <span class="stringliteral">&quot;--color=&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<a class="code" href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a>(dash_prime, <span class="stringliteral">&quot;--prime=&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//rules</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">using</span> rgb = or_&lt;red, green, blue&gt;;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">using</span> prime_num = or_&lt;one, three, five&gt;;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">using</span> color_param = and_&lt;dash_color, rgb&gt;;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">using</span> prime_param = and_&lt;dash_prime, prime_num&gt;;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">using</span> parameter = or_&lt;color_param, prime_param&gt;;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;~~~</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;The `parameter` maybe either `--prime=&lt;prime_num&gt;` or `--color=&lt;rgb&gt;`. `&lt;prime_num&gt;` and `&lt;rgb&gt;` maybe either `red, green` or `blue` and `1, 3` or  `5` respectively. This example uses a mixture of preprocessor macros and <span class="keyword">template</span> aliases to define the grammar. The C++ representation is more verbose due to C++ language requirements but it maps to the BNF line-<span class="keywordflow">for</span>-line.</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;Using <span class="keyword">this</span> specification to parse command line parameters is a matter of passing the start rule and <span class="keywordtype">string</span> to a parser:</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;~~~{.cpp}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * argv[]){</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    std::string sParam = argv[1];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">auto</span> oAST = <a class="code" href="classxtd_1_1parser.html#af0a78e430f2a4fcbef82ed012366cdcf">xtd::parser&lt;parameter&gt;::parse</a>(sParam.begin(), sParam.end());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (!oAST){</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment">//parse failed, show usage or error</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="comment">//work with parsed parameters</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;~~~</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;Done and done.</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;AST Generation</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;--------------</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;An AST is instantated and returned by `<a class="code" href="classxtd_1_1parser.html#af0a78e430f2a4fcbef82ed012366cdcf">xtd::parser&lt;&gt;::parse</a>()` when the parse is successful. The AST is an <span class="keywordtype">object</span> model that represents the parsed grammar.</div>
<div class="ttc" id="parse_8hpp_html_a6b587a2620e69f0a0168131a13f6c070"><div class="ttname"><a href="parse_8hpp.html#a6b587a2620e69f0a0168131a13f6c070">STRING</a></div><div class="ttdeci">#define STRING(_name, _value)</div><div class="ttdoc">Declares a string terminal Must be used at namespace scope. </div><div class="ttdef"><b>Definition:</b> <a href="parse_8hpp_source.html#l00038">parse.hpp:38</a></div></div>
<div class="ttc" id="classxtd_1_1parser_html_af0a78e430f2a4fcbef82ed012366cdcf"><div class="ttname"><a href="classxtd_1_1parser.html#af0a78e430f2a4fcbef82ed012366cdcf">xtd::parser::parse</a></div><div class="ttdeci">static parse::rule_base::pointer_type parse(_iterator_t begin, _iterator_t end)</div><div class="ttdoc">Parses text. </div><div class="ttdef"><b>Definition:</b> <a href="parse_8hpp_source.html#l00535">parse.hpp:535</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Parsing.md</b></li>
    <li class="footer">Generated on Tue Aug 9 2016 19:59:26 for XTL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
